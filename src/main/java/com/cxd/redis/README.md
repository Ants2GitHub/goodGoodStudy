http://zhangtielei.com/posts/blog-redlock-reasoning-part2.html